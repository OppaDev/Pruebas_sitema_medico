ù
oC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDBContext *
>* +
(+ ,
options, 3
=>4 6
options 
. 
UseSqlServer 
( 
builder  
.  !
Configuration! .
.. /
GetConnectionString/ B
(B C
$strC V
)V W
)W X
)X Y
;Y Z
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app!! 
.!! 
MapControllers!! 
(!! 
)!! 
;!! 
await## 
app## 	
.##	 

RunAsync##
 
(## 
)## 
;## »K
èC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\Migrations\20250121020732_InitialCreate.cs
	namespace 	
SistemaCitasMedicas
 
. 

Migrations (
{ 
public		 

partial		 
class		 
InitialCreate		 &
:		' (
	Migration		) 2
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
IdCita 
= 
table "
." #
Column# )
<) *
int* -
>- .
(. /
type/ 3
:3 4
$str5 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Fecha 
= 
table !
.! "
Column" (
<( )
DateTime) 1
>1 2
(2 3
type3 7
:7 8
$str9 D
,D E
nullableF N
:N O
trueP T
)T U
,U V
Hora 
= 
table  
.  !
Column! '
<' (
TimeSpan( 0
>0 1
(1 2
type2 6
:6 7
$str8 >
,> ?
nullable@ H
:H I
trueJ N
)N O
,O P

IdPaciente 
=  
table! &
.& '
Column' -
<- .
int. 1
>1 2
(2 3
type3 7
:7 8
$str9 >
,> ?
nullable@ H
:H I
trueJ N
)N O
,O P
IdDoctor 
= 
table $
.$ %
Column% +
<+ ,
int, /
>/ 0
(0 1
type1 5
:5 6
$str7 <
,< =
nullable> F
:F G
trueH L
)L M
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% /
,/ 0
x1 2
=>3 5
x6 7
.7 8
IdCita8 >
)> ?
;? @
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns   
:   
table   
=>   !
new  " %
{!! 
IdDoctor"" 
="" 
table"" $
.""$ %
Column""% +
<""+ ,
int"", /
>""/ 0
(""0 1
type""1 5
:""5 6
$str""7 <
,""< =
nullable""> F
:""F G
false""H M
)""M N
.## 

Annotation## #
(### $
$str##$ 8
,##8 9
$str##: @
)##@ A
,##A B
Nombre$$ 
=$$ 
table$$ "
.$$" #
Column$$# )
<$$) *
string$$* 0
>$$0 1
($$1 2
type$$2 6
:$$6 7
$str$$8 G
,$$G H
nullable$$I Q
:$$Q R
true$$S W
)$$W X
,$$X Y
Apellido%% 
=%% 
table%% $
.%%$ %
Column%%% +
<%%+ ,
string%%, 2
>%%2 3
(%%3 4
type%%4 8
:%%8 9
$str%%: I
,%%I J
nullable%%K S
:%%S T
true%%U Y
)%%Y Z
,%%Z [
Especialidad&&  
=&&! "
table&&# (
.&&( )
Column&&) /
<&&/ 0
string&&0 6
>&&6 7
(&&7 8
type&&8 <
:&&< =
$str&&> M
,&&M N
nullable&&O W
:&&W X
true&&Y ]
)&&] ^
}'' 
,'' 
constraints(( 
:(( 
table(( "
=>((# %
{)) 
table** 
.** 

PrimaryKey** $
(**$ %
$str**% 2
,**2 3
x**4 5
=>**6 8
x**9 :
.**: ;
IdDoctor**; C
)**C D
;**D E
}++ 
)++ 
;++ 
migrationBuilder-- 
.-- 
CreateTable-- (
(--( )
name.. 
:.. 
$str.. !
,..! "
columns// 
:// 
table// 
=>// !
new//" %
{00 

IdPaciente11 
=11  
table11! &
.11& '
Column11' -
<11- .
int11. 1
>111 2
(112 3
type113 7
:117 8
$str119 >
,11> ?
nullable11@ H
:11H I
false11J O
)11O P
.22 

Annotation22 #
(22# $
$str22$ 8
,228 9
$str22: @
)22@ A
,22A B
Nombre33 
=33 
table33 "
.33" #
Column33# )
<33) *
string33* 0
>330 1
(331 2
type332 6
:336 7
$str338 G
,33G H
nullable33I Q
:33Q R
true33S W
)33W X
,33X Y
Apellido44 
=44 
table44 $
.44$ %
Column44% +
<44+ ,
string44, 2
>442 3
(443 4
type444 8
:448 9
$str44: I
,44I J
nullable44K S
:44S T
true44U Y
)44Y Z
,44Z [
FechaNacimiento55 #
=55$ %
table55& +
.55+ ,
Column55, 2
<552 3
DateTime553 ;
>55; <
(55< =
type55= A
:55A B
$str55C N
,55N O
nullable55P X
:55X Y
true55Z ^
)55^ _
}66 
,66 
constraints77 
:77 
table77 "
=>77# %
{88 
table99 
.99 

PrimaryKey99 $
(99$ %
$str99% 3
,993 4
x995 6
=>997 9
x99: ;
.99; <

IdPaciente99< F
)99F G
;99G H
}:: 
):: 
;:: 
migrationBuilder<< 
.<< 
CreateTable<< (
(<<( )
name== 
:== 
$str== &
,==& '
columns>> 
:>> 
table>> 
=>>> !
new>>" %
{?? 
IdProcedimiento@@ #
=@@$ %
table@@& +
.@@+ ,
Column@@, 2
<@@2 3
int@@3 6
>@@6 7
(@@7 8
type@@8 <
:@@< =
$str@@> C
,@@C D
nullable@@E M
:@@M N
false@@O T
)@@T U
.AA 

AnnotationAA #
(AA# $
$strAA$ 8
,AA8 9
$strAA: @
)AA@ A
,AAA B
DescripcionBB 
=BB  !
tableBB" '
.BB' (
ColumnBB( .
<BB. /
stringBB/ 5
>BB5 6
(BB6 7
typeBB7 ;
:BB; <
$strBB= L
,BBL M
nullableBBN V
:BBV W
trueBBX \
)BB\ ]
,BB] ^
CostoCC 
=CC 
tableCC !
.CC! "
ColumnCC" (
<CC( )
decimalCC) 0
>CC0 1
(CC1 2
typeCC2 6
:CC6 7
$strCC8 G
,CCG H
nullableCCI Q
:CCQ R
falseCCS X
)CCX Y
,CCY Z
IdCitaDD 
=DD 
tableDD "
.DD" #
ColumnDD# )
<DD) *
intDD* -
>DD- .
(DD. /
typeDD/ 3
:DD3 4
$strDD5 :
,DD: ;
nullableDD< D
:DDD E
trueDDF J
)DDJ K
}EE 
,EE 
constraintsFF 
:FF 
tableFF "
=>FF# %
{GG 
tableHH 
.HH 

PrimaryKeyHH $
(HH$ %
$strHH% 8
,HH8 9
xHH: ;
=>HH< >
xHH? @
.HH@ A
IdProcedimientoHHA P
)HHP Q
;HHQ R
}II 
)II 
;II 
}JJ 	
	protectedMM 
overrideMM 
voidMM 
DownMM  $
(MM$ %
MigrationBuilderMM% 5
migrationBuilderMM6 F
)MMF G
{NN 	
migrationBuilderOO 
.OO 
	DropTableOO &
(OO& '
namePP 
:PP 
$strPP 
)PP 
;PP 
migrationBuilderRR 
.RR 
	DropTableRR &
(RR& '
nameSS 
:SS 
$strSS  
)SS  !
;SS! "
migrationBuilderUU 
.UU 
	DropTableUU &
(UU& '
nameVV 
:VV 
$strVV !
)VV! "
;VV" #
migrationBuilderXX 
.XX 
	DropTableXX &
(XX& '
nameYY 
:YY 
$strYY &
)YY& '
;YY' (
}ZZ 	
}[[ 
}\\ ¡2
åC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\Controllers\ProcedimientosController.cs
	namespace 	
SistemaCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class $
ProcedimientosController )
:* +
ControllerBase, :
{		 
private

 
readonly

 
AppDBContext

 %

_dbContext

& 0
;

0 1
public $
ProcedimientosController '
(' (
AppDBContext( 4
	dbContext5 >
)> ?
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetProcedimientos) :
(: ;
); <
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
Procedimientos' 5
.5 6
ToListAsync6 A
(A B
)B C
)C D
;D E
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
CreateProcedimiento) <
(< =
Procedimientos= K
procedimientoL Y
)Y Z
{ 	
if 
( 
procedimiento 
. 
Costo #
<$ %
$num& '
)' (
{ 
return 

BadRequest !
(! "
$str" ?
)? @
;@ A
} 
var 

citaExiste 
= 
await "

_dbContext# -
.- .
Citas. 3
.3 4
AnyAsync4 <
(< =
c= >
=>? A
cB C
.C D
IdCitaD J
==K M
procedimientoN [
.[ \
IdCita\ b
)b c
;c d
if 
( 
! 

citaExiste 
) 
{ 
return   

BadRequest   !
(  ! "
$str  " 5
)  5 6
;  6 7
}!! 

_dbContext"" 
."" 
Procedimientos"" %
.""% &
Add""& )
("") *
procedimiento""* 7
)""7 8
;""8 9
await## 

_dbContext## 
.## 
SaveChangesAsync## -
(##- .
)##. /
;##/ 0
return$$ 
Ok$$ 
($$ 
procedimiento$$ #
)$$# $
;$$$ %
}%% 	
['' 	
HttpPut''	 
]'' 
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' (
UpdateProcedimiento(() <
(((< =
Procedimientos((= K
procedimiento((L Y
)((Y Z
{)) 	
if** 
(** 
procedimiento** 
.** 
Costo** #
<**$ %
$num**& '
)**' (
{++ 
return,, 

BadRequest,, !
(,,! "
$str,," ?
),,? @
;,,@ A
}-- 
var.. 

citaExiste.. 
=.. 
await.. "

_dbContext..# -
...- .
Citas... 3
...3 4
AnyAsync..4 <
(..< =
c..= >
=>..? A
c..B C
...C D
IdCita..D J
==..K M
procedimiento..N [
...[ \
IdCita..\ b
)..b c
;..c d
if// 
(// 
!// 

citaExiste// 
)// 
{00 
return11 

BadRequest11 !
(11! "
$str11" 5
)115 6
;116 7
}22 

_dbContext33 
.33 
Entry33 
(33 
procedimiento33 *
)33* +
.33+ ,
State33, 1
=332 3
EntityState334 ?
.33? @
Modified33@ H
;33H I
await44 

_dbContext44 
.44 
SaveChangesAsync44 -
(44- .
)44. /
;44/ 0
return55 
Ok55 
(55 
procedimiento55 #
)55# $
;55$ %
}66 	
[88 	

HttpDelete88	 
(88 
$str88 
)88 
]88 
public99 
async99 
Task99 
<99 
IActionResult99 '
>99' (
DeleteProcedimiento99) <
(99< =
int99= @
id99A C
)99C D
{:: 	
var;; 
procedimiento;; 
=;; 
await;;  %

_dbContext;;& 0
.;;0 1
Procedimientos;;1 ?
.;;? @
	FindAsync;;@ I
(;;I J
id;;J L
);;L M
;;;M N
var<< 
cita<< 
=<< 
await<< 

_dbContext<< '
.<<' (
Citas<<( -
.<<- .
FirstOrDefaultAsync<<. A
(<<A B
x<<B C
=><<D F
x<<G H
.<<H I
IdCita<<I O
==<<P R
id<<S U
)<<U V
;<<V W
if== 
(== 
cita== 
!=== 
null== 
)== 
{>> 
return?? 

BadRequest?? !
(??! "
$str??" `
)??` a
;??a b
}@@ 
ifAA 
(AA 
procedimientoAA 
==AA  
nullAA! %
)AA% &
{BB 
returnCC 

BadRequestCC !
(CC! "
$strCC" -
)CC- .
;CC. /
}DD 

_dbContextEE 
.EE 
ProcedimientosEE %
.EE% &
RemoveEE& ,
(EE, -
procedimientoEE- :
)EE: ;
;EE; <
awaitFF 

_dbContextFF 
.FF 
SaveChangesAsyncFF -
(FF- .
)FF. /
;FF/ 0
returnGG 
OkGG 
(GG 
)GG 
;GG 
}HH 	
}II 
}JJ ˇ0
áC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\Controllers\PacientesController.cs
	namespace 	
SistemaCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
PacientesController $
:% &
ControllerBase' 5
{		 
private

 
readonly

 
AppDBContext

 %

_dbContext

& 0
;

0 1
public 
PacientesController "
(" #
AppDBContext# /
	dbContext0 9
)9 :
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetPacientes) 5
(5 6
)6 7
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
	Pacientes' 0
.0 1
ToListAsync1 <
(< =
)= >
)> ?
;? @
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
CreatePaciente) 7
(7 8
	Pacientes8 A
pacienteB J
)J K
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
paciente* 2
.2 3
Nombre3 9
)9 :
||; =
string 
. 
IsNullOrWhiteSpace )
() *
paciente* 2
.2 3
Apellido3 ;
); <
)< =
{ 
return 

BadRequest !
(! "
$str" D
)D E
;E F
} 
if   
(   
paciente   
.   
FechaNacimiento   (
>  ) *
DateTime  + 3
.  3 4
Today  4 9
)  9 :
{!! 
return"" 

BadRequest"" !
(""! "
$str""" C
)""C D
;""D E
}## 

_dbContext$$ 
.$$ 
	Pacientes$$  
.$$  !
Add$$! $
($$$ %
paciente$$% -
)$$- .
;$$. /
await%% 

_dbContext%% 
.%% 
SaveChangesAsync%% -
(%%- .
)%%. /
;%%/ 0
return&& 
Ok&& 
(&& 
paciente&& 
)&& 
;&&  
}'' 	
[** 	
HttpPut**	 
]** 
public++ 
async++ 
Task++ 
<++ 
IActionResult++ '
>++' (
UpdatePaciente++) 7
(++7 8
	Pacientes++8 A
paciente++B J
)++J K
{,, 	
if-- 
(-- 
string-- 
.-- 
IsNullOrWhiteSpace-- )
(--) *
paciente--* 2
.--2 3
Nombre--3 9
)--9 :
||--; =
string.. 
... 
IsNullOrWhiteSpace.. )
(..) *
paciente..* 2
...2 3
Apellido..3 ;
)..; <
)..< =
{// 
return00 

BadRequest00 !
(00! "
$str00" D
)00D E
;00E F
}11 
if22 
(22 
paciente22 
.22 
FechaNacimiento22 (
>22) *
DateTime22+ 3
.223 4
Today224 9
)229 :
{33 
return44 

BadRequest44 !
(44! "
$str44" C
)44C D
;44D E
}55 

_dbContext66 
.66 
Entry66 
(66 
paciente66 %
)66% &
.66& '
State66' ,
=66- .
EntityState66/ :
.66: ;
Modified66; C
;66C D
await77 

_dbContext77 
.77 
SaveChangesAsync77 -
(77- .
)77. /
;77/ 0
return88 
Ok88 
(88 
paciente88 
)88 
;88  
}99 	
[;; 	

HttpDelete;;	 
(;; 
$str;; 
);; 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
DeletePaciente<<) 7
(<<7 8
int<<8 ;
id<<< >
)<<> ?
{== 	
var>> 
paciente>> 
=>> 
await>>  

_dbContext>>! +
.>>+ ,
	Pacientes>>, 5
.>>5 6
	FindAsync>>6 ?
(>>? @
id>>@ B
)>>B C
;>>C D
var?? 
cita?? 
=?? 
await?? 

_dbContext?? '
.??' (
Citas??( -
.??- .
FirstOrDefaultAsync??. A
(??A B
x??B C
=>??D F
x??G H
.??H I

IdPaciente??I S
==??T V
id??W Y
)??Y Z
;??Z [
if@@ 
(@@ 
cita@@ 
!=@@ 
null@@ 
)@@ 
{AA 
returnBB 

BadRequestBB !
(BB! "
$strBB" [
)BB[ \
;BB\ ]
}CC 
ifDD 
(DD 
pacienteDD 
==DD 
nullDD  
)DD  !
{EE 
returnFF 

BadRequestFF !
(FF! "
$strFF" -
)FF- .
;FF. /
}GG 

_dbContextHH 
.HH 
	PacientesHH  
.HH  !
RemoveHH! '
(HH' (
pacienteHH( 0
)HH0 1
;HH1 2
awaitII 

_dbContextII 
.II 
SaveChangesAsyncII -
(II- .
)II. /
;II/ 0
returnJJ 
OkJJ 
(JJ 
)JJ 
;JJ 
}KK 	
}LL 
}MM √.
ÜC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\Controllers\DoctoresController.cs
	namespace 	
SistemaCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
DoctoresController #
:$ %
ControllerBase& 4
{		 
private

 
readonly

 
AppDBContext

 %

_dbContext

& 0
;

0 1
public 
DoctoresController !
(! "
AppDBContext" .
	dbContext/ 8
)8 9
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetDoctores) 4
(4 5
)5 6
{ 	
return 
Ok 
( 
await 

_dbContext &
.& '
Doctores' /
./ 0
ToListAsync0 ;
(; <
)< =
)= >
;> ?
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
CreateDoctor) 5
(5 6
Doctores6 >
doctor? E
)E F
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
doctor* 0
.0 1
Nombre1 7
)7 8
||9 ;
string 
. 
IsNullOrWhiteSpace )
() *
doctor* 0
.0 1
Apellido1 9
)9 :
||; =
string 
. 
IsNullOrWhiteSpace )
() *
doctor* 0
.0 1
Especialidad1 =
)= >
)> ?
{ 
return 

BadRequest !
(! "
$str" R
)R S
;S T
} 

_dbContext   
.   
Doctores   
.    
Add    #
(  # $
doctor  $ *
)  * +
;  + ,
await!! 

_dbContext!! 
.!! 
SaveChangesAsync!! -
(!!- .
)!!. /
;!!/ 0
return"" 
Ok"" 
("" 
doctor"" 
)"" 
;"" 
}## 	
[%% 	
HttpPut%%	 
]%% 
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (
UpdateDoctor&&) 5
(&&5 6
Doctores&&6 >
doctor&&? E
)&&E F
{'' 	
if(( 
((( 
string(( 
.(( 
IsNullOrWhiteSpace(( )
((() *
doctor((* 0
.((0 1
Nombre((1 7
)((7 8
||((9 ;
string)) 
.)) 
IsNullOrWhiteSpace)) (
())( )
doctor))) /
.))/ 0
Apellido))0 8
)))8 9
||)): <
string** 
.** 
IsNullOrWhiteSpace** (
(**( )
doctor**) /
.**/ 0
Especialidad**0 <
)**< =
)**= >
{++ 
return,, 

BadRequest,, !
(,,! "
$str,," R
),,R S
;,,S T
}-- 

_dbContext.. 
... 
Entry.. 
(.. 
doctor.. #
)..# $
...$ %
State..% *
=..+ ,
EntityState..- 8
...8 9
Modified..9 A
;..A B
await// 

_dbContext// 
.// 
SaveChangesAsync// -
(//- .
)//. /
;/// 0
return00 
Ok00 
(00 
doctor00 
)00 
;00 
}11 	
[33 	

HttpDelete33	 
(33 
$str33 
)33 
]33 
public44 
async44 
Task44 
<44 
IActionResult44 '
>44' (
DeleteDoctor44) 5
(445 6
int446 9
id44: <
)44< =
{55 	
var66 
doctor66 
=66 
await66 

_dbContext66 )
.66) *
Doctores66* 2
.662 3
	FindAsync663 <
(66< =
id66= ?
)66? @
;66@ A
var77 
cita77 
=77 
await77 

_dbContext77 '
.77' (
Citas77( -
.77- .
FirstOrDefaultAsync77. A
(77A B
x77B C
=>77D F
x77G H
.77H I
IdDoctor77I Q
==77R T
id77U W
)77W X
;77X Y
if88 
(88 
cita88 
!=88 
null88 
)88 
{99 
return:: 

BadRequest:: !
(::! "
$str::" Y
)::Y Z
;::Z [
};; 
if<< 
(<< 
doctor<< 
==<< 
null<< 
)<< 
{== 
return>> 

BadRequest>> !
(>>! "
$str>>" -
)>>- .
;>>. /
}?? 

_dbContext@@ 
.@@ 
Doctores@@ 
.@@  
Remove@@  &
(@@& '
doctor@@' -
)@@- .
;@@. /
awaitAA 

_dbContextAA 
.AA 
SaveChangesAsyncAA -
(AA- .
)AA. /
;AA/ 0
returnBB 
OkBB 
(BB 
doctorBB 
)BB 
;BB 
}CC 	
}DD 
}EE Ÿ;
ÉC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\Controllers\CitasController.cs
	namespace 	
SistemaCitasMedicas
 
. 
Controllers )
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
CitasController  
:! "
ControllerBase# 1
{		 
private

 
readonly

 
AppDBContext

 %

_dbContext

& 0
;

0 1
public 
CitasController 
( 
AppDBContext +
	dbContext, 5
)5 6
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
private 
async 
Task 
< 
IActionResult (
?( )
>) *
ValidarCita+ 6
(6 7
Citas7 <
cita= A
)A B
{ 	
if 
( 
cita 
. 
Fecha 
< 
DateTime %
.% &
Today& +
)+ ,
{ 
return 

BadRequest !
(! "
$str" 5
)5 6
;6 7
} 
if 
( 
cita 
. 
Hora 
< 
TimeSpan $
.$ %
	FromHours% .
(. /
$num/ 0
)0 1
||2 4
cita5 9
.9 :
Hora: >
>? @
TimeSpanA I
.I J
	FromHoursJ S
(S T
$numT V
)V W
)W X
{ 
return 

BadRequest !
(! "
$str" 4
)4 5
;5 6
} 
var 
pacienteExiste 
=  
await! &

_dbContext' 1
.1 2
	Pacientes2 ;
.; <
AnyAsync< D
(D E
pE F
=>G I
pJ K
.K L

IdPacienteL V
==W Y
citaZ ^
.^ _

IdPaciente_ i
)i j
;j k
if 
( 
! 
pacienteExiste 
)  
{   
return!! 

BadRequest!! !
(!!! "
$str!!" 9
)!!9 :
;!!: ;
}"" 
var$$ 
doctorExiste$$ 
=$$ 
await$$ $

_dbContext$$% /
.$$/ 0
Doctores$$0 8
.$$8 9
AnyAsync$$9 A
($$A B
d$$B C
=>$$D F
d$$G H
.$$H I
IdDoctor$$I Q
==$$R T
cita$$U Y
.$$Y Z
IdDoctor$$Z b
)$$b c
;$$c d
if%% 
(%% 
!%% 
doctorExiste%% 
)%% 
{&& 
return'' 

BadRequest'' !
(''! "
$str''" 7
)''7 8
;''8 9
}(( 
return** 
null** 
;** 
}++ 	
[-- 	
HttpGet--	 
]-- 
public.. 
async.. 
Task.. 
<.. 
IActionResult.. '
>..' (
GetCitas..) 1
(..1 2
)..2 3
{// 	
return00 
Ok00 
(00 
await00 

_dbContext00 &
.00& '
Citas00' ,
.00, -
ToListAsync00- 8
(008 9
)009 :
)00: ;
;00; <
}11 	
[33 	
HttpPost33	 
]33 
public44 
async44 
Task44 
<44 
IActionResult44 '
>44' (

CreateCita44) 3
(443 4
Citas444 9
cita44: >
)44> ?
{55 	
var66 
validationResult66  
=66! "
await66# (
ValidarCita66) 4
(664 5
cita665 9
)669 :
;66: ;
if77 
(77 
validationResult77  
!=77! #
null77$ (
)77( )
{88 
return99 
validationResult99 '
;99' (
}:: 

_dbContext<< 
.<< 
Citas<< 
.<< 
Add<<  
(<<  !
cita<<! %
)<<% &
;<<& '
await== 

_dbContext== 
.== 
SaveChangesAsync== -
(==- .
)==. /
;==/ 0
return>> 
Ok>> 
(>> 
)>> 
;>> 
}?? 	
[AA 	
HttpPutAA	 
]AA 
publicBB 
asyncBB 
TaskBB 
<BB 
IActionResultBB '
>BB' (

UpdateCitaBB) 3
(BB3 4
CitasBB4 9
citaBB: >
)BB> ?
{CC 	
varDD 
validationResultDD  
=DD! "
awaitDD# (
ValidarCitaDD) 4
(DD4 5
citaDD5 9
)DD9 :
;DD: ;
ifEE 
(EE 
validationResultEE  
!=EE! #
nullEE$ (
)EE( )
{FF 
returnGG 
validationResultGG '
;GG' (
}HH 

_dbContextJJ 
.JJ 
EntryJJ 
(JJ 
citaJJ !
)JJ! "
.JJ" #
StateJJ# (
=JJ) *
EntityStateJJ+ 6
.JJ6 7
ModifiedJJ7 ?
;JJ? @
awaitKK 

_dbContextKK 
.KK 
SaveChangesAsyncKK -
(KK- .
)KK. /
;KK/ 0
returnLL 
OkLL 
(LL 
citaLL 
)LL 
;LL 
}MM 	
[OO 	

HttpDeleteOO	 
(OO 
$strOO 
)OO 
]OO 
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (

DeleteCitaPP) 3
(PP3 4
intPP4 7
idPP8 :
)PP: ;
{QQ 	
varRR 
citaRR 
=RR 
awaitRR 

_dbContextRR '
.RR' (
CitasRR( -
.RR- .
	FindAsyncRR. 7
(RR7 8
idRR8 :
)RR: ;
;RR; <
varSS 
procedimientoSS 
=SS 
awaitSS  %

_dbContextSS& 0
.SS0 1
ProcedimientosSS1 ?
.SS? @
FirstOrDefaultAsyncSS@ S
(SSS T
xSST U
=>SSV X
xSSY Z
.SSZ [
IdCitaSS[ a
==SSb d
idSSe g
)SSg h
;SSh i
ifTT 
(TT 
procedimientoTT 
!=TT  
nullTT! %
)TT% &
{UU 
returnVV 

BadRequestVV !
(VV! "
$strVV" `
)VV` a
;VVa b
}WW 
ifXX 
(XX 
citaXX 
==XX 
nullXX 
)XX 
{YY 
returnZZ 

BadRequestZZ !
(ZZ! "
$strZZ" -
)ZZ- .
;ZZ. /
}[[ 

_dbContext]] 
.]] 
Citas]] 
.]] 
Remove]] #
(]]# $
cita]]$ (
)]]( )
;]]) *
await^^ 

_dbContext^^ 
.^^ 
SaveChangesAsync^^ -
(^^- .
)^^. /
;^^/ 0
return__ 
Ok__ 
(__ 
)__ 
;__ 
}`` 	
}aa 
}bb ˝&
tC:\Users\OppaDev\Desktop\Pruebas de Software\Segundo parcial\SistemaCitasMedicas\SistemaCitasMedicas\AppDBContext.cs
	namespace 	
SistemaCitasMedicas
 
{ 
public 

class 
AppDBContext 
: 
	DbContext  )
{		 
public

 
AppDBContext

 
(

 
DbContextOptions

 ,
<

, -
AppDBContext

- 9
>

9 :
options

; B
)

B C
:

D E
base

F J
(

J K
options

K R
)

R S
{

T U
} 	
public 
DbSet 
< 
	Pacientes 
> 
	Pacientes  )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
DbSet 
< 
Doctores 
> 
Doctores '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
Citas 
> 
Citas !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DbSet 
< 
Procedimientos #
># $
Procedimientos% 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
} 
public 

class 
	Pacientes 
{ 
[ 	
Key	 
] 
public 
required 
int 

IdPaciente &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 
Nombre 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Apellido 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
? 
FechaNacimiento (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
} 
public 

class 
Doctores 
{   
[!! 	
Key!!	 
]!! 
public"" 
required"" 
int"" 
IdDoctor"" $
{""% &
get""' *
;""* +
set"", /
;""/ 0
}""1 2
public## 
string## 
?## 
Nombre## 
{## 
get##  #
;### $
set##% (
;##( )
}##* +
public$$ 
string$$ 
?$$ 
Apellido$$ 
{$$  !
get$$" %
;$$% &
set$$' *
;$$* +
}$$, -
public%% 
string%% 
?%% 
Especialidad%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
}&& 
public(( 

class(( 
Citas(( 
{)) 
[** 	
Key**	 
]** 
public++ 
required++ 
int++ 
IdCita++ "
{++# $
get++% (
;++( )
set++* -
;++- .
}++/ 0
public,, 
DateTime,, 
?,, 
Fecha,, 
{,,  
get,,! $
;,,$ %
set,,& )
;,,) *
},,+ ,
public-- 
TimeSpan-- 
?-- 
Hora-- 
{-- 
get--  #
;--# $
set--% (
;--( )
}--* +
public.. 
int.. 
?.. 

IdPaciente.. 
{..  
get..! $
;..$ %
set..& )
;..) *
}..+ ,
public// 
int// 
?// 
IdDoctor// 
{// 
get// "
;//" #
set//$ '
;//' (
}//) *
}00 
public22 

class22 
Procedimientos22 
{33 
[44 	
Key44	 
]44 
public55 
required55 
int55 
IdProcedimiento55 +
{55, -
get55. 1
;551 2
set553 6
;556 7
}558 9
public66 
string66 
?66 
Descripcion66 "
{66# $
get66% (
;66( )
set66* -
;66- .
}66/ 0
[77 	
JsonRequired77	 
]77 
public77 
decimal77 %
Costo77& +
{77, -
get77. 1
;771 2
set773 6
;776 7
}778 9
public88 
int88 
?88 
IdCita88 
{88 
get88  
;88  !
set88" %
;88% &
}88' (
}99 
}:: 